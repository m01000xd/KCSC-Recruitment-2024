### Elif
```python3
flag = input('Enter your flag: ')
if len(flag) != 49:
    print('Wrong Length!!!')
    exit()
inp = [ord(c) for c in flag]
if inp[30] + inp[44] + inp[16] + inp[38] + inp[47] + inp[7] != 398:
    print('Wrong Flag!!!')
    exit()
elif inp[41] + inp[22] + inp[38] + inp[33] + inp[28] + inp[20] != 451:
    print('Wrong Flag!!!')
    exit()
elif inp[10] + inp[3] + inp[39] + inp[14] + inp[4] + inp[47] != 440:
    print('Wrong Flag!!!')
    exit()
elif inp[2] + inp[12] + inp[45] + inp[4] + inp[42] + inp[30] != 581:
    print('Wrong Flag!!!')
    exit()
elif inp[36] + inp[36] + inp[26] + inp[43] + inp[21] + inp[1] != 587:
    print('Wrong Flag!!!')
    exit()
elif inp[16] + inp[3] + inp[16] + inp[20] + inp[38] + inp[39] != 274:
    print('Wrong Flag!!!')
    exit()
elif inp[28] + inp[39] + inp[18] + inp[38] + inp[47] + inp[8] != 372:
    print('Wrong Flag!!!')
    exit()
elif inp[25] + inp[19] + inp[36] + inp[19] + inp[20] + inp[31] != 470:
    print('Wrong Flag!!!')
    exit()
elif inp[44] + inp[27] + inp[5] + inp[41] + inp[16] + inp[42] != 565:
    print('Wrong Flag!!!')
    exit()
elif inp[46] + inp[35] + inp[8] + inp[1] + inp[4] + inp[47] != 447:
    print('Wrong Flag!!!')
    exit()
elif inp[41] + inp[20] + inp[42] + inp[40] + inp[3] + inp[43] != 503:
    print('Wrong Flag!!!')
    exit()
elif inp[36] + inp[4] + inp[21] + inp[46] + inp[34] + inp[38] != 532:
    print('Wrong Flag!!!')
    exit()
elif inp[43] + inp[45] + inp[3] + inp[45] + inp[3] + inp[17] != 382:
    print('Wrong Flag!!!')
    exit()
elif inp[24] + inp[2] + inp[6] + inp[2] + inp[25] + inp[1] != 490:
    print('Wrong Flag!!!')
    exit()
elif inp[38] + inp[41] + inp[33] + inp[34] + inp[21] + inp[42] != 569:
    print('Wrong Flag!!!')
    exit()
elif inp[17] + inp[38] + inp[1] + inp[15] + inp[46] + inp[35] != 364:
    print('Wrong Flag!!!')
    exit()
elif inp[40] + inp[17] + inp[34] + inp[33] + inp[39] + inp[19] != 398:
    print('Wrong Flag!!!')
    exit()
elif inp[18] + inp[21] + inp[4] + inp[27] + inp[19] + inp[29] != 541:
    print('Wrong Flag!!!')
    exit()
elif inp[30] + inp[34] + inp[42] + inp[26] + inp[18] + inp[47] != 588:
    print('Wrong Flag!!!')
    exit()
elif inp[23] + inp[24] + inp[30] + inp[1] + inp[13] + inp[7] != 471:
    print('Wrong Flag!!!')
    exit()
elif inp[17] + inp[16] + inp[32] + inp[16] + inp[15] + inp[14] != 343:
    print('Wrong Flag!!!')
    exit()
elif inp[30] + inp[10] + inp[24] + inp[3] + inp[40] + inp[3] != 519:
    print('Wrong Flag!!!')
    exit()
elif inp[10] + inp[34] + inp[27] + inp[38] + inp[46] + inp[40] != 480:
    print('Wrong Flag!!!')
    exit()
elif inp[6] + inp[6] + inp[46] + inp[35] + inp[5] + inp[13] != 357:
    print('Wrong Flag!!!')
    exit()
elif inp[18] + inp[16] + inp[5] + inp[6] + inp[12] + inp[32] != 411:
    print('Wrong Flag!!!')
    exit()
elif inp[1] + inp[3] + inp[37] + inp[4] + inp[22] + inp[44] != 514:
    print('Wrong Flag!!!')
    exit()
elif inp[26] + inp[11] + inp[12] + inp[47] + inp[22] + inp[2] != 541:
    print('Wrong Flag!!!')
    exit()
elif inp[32] + inp[32] + inp[18] + inp[34] + inp[31] + inp[37] != 454:
    print('Wrong Flag!!!')
    exit()
elif inp[38] + inp[25] + inp[1] + inp[23] + inp[28] + inp[27] != 403:
    print('Wrong Flag!!!')
    exit()
elif inp[37] + inp[11] + inp[2] + inp[24] + inp[39] + inp[21] != 457:
    print('Wrong Flag!!!')
    exit()
elif inp[21] + inp[4] + inp[3] + inp[11] + inp[42] + inp[2] != 588:
    print('Wrong Flag!!!')
    exit()
elif inp[11] + inp[36] + inp[27] + inp[1] + inp[18] + inp[19] != 549:
    print('Wrong Flag!!!')
    exit()
elif inp[16] + inp[18] + inp[37] + inp[41] + inp[25] + inp[45] != 446:
    print('Wrong Flag!!!')
    exit()
elif inp[19] + inp[19] + inp[18] + inp[8] + inp[25] + inp[14] != 453:
    print('Wrong Flag!!!')
    exit()
elif inp[19] + inp[2] + inp[40] + inp[34] + inp[27] + inp[5] != 461:
    print('Wrong Flag!!!')
    exit()
elif inp[48] + inp[41] + inp[33] + inp[41] + inp[23] + inp[37] != 533:
    print('Wrong Flag!!!')
    exit()
elif inp[45] + inp[9] + inp[8] + inp[32] + inp[4] + inp[26] != 531:
    print('Wrong Flag!!!')
    exit()
elif inp[47] + inp[27] + inp[2] + inp[32] + inp[3] + inp[38] != 393:
    print('Wrong Flag!!!')
    exit()
elif inp[32] + inp[27] + inp[2] + inp[34] + inp[27] + inp[14] != 506:
    print('Wrong Flag!!!')
    exit()
elif inp[24] + inp[14] + inp[39] + inp[20] + inp[3] + inp[17] != 365:
    print('Wrong Flag!!!')
    exit()
elif inp[10] + inp[17] + inp[43] + inp[28] + inp[48] + inp[48] != 565:
    print('Wrong Flag!!!')
    exit()
elif inp[35] + inp[47] + inp[27] + inp[42] + inp[35] + inp[37] != 415:
    print('Wrong Flag!!!')
    exit()
elif inp[10] + inp[37] + inp[37] + inp[44] + inp[21] + inp[15] != 502:
    print('Wrong Flag!!!')
    exit()
elif inp[9] + inp[44] + inp[9] + inp[48] + inp[38] + inp[15] != 600:
    print('Wrong Flag!!!')
    exit()
elif inp[16] + inp[47] + inp[12] + inp[27] + inp[39] + inp[16] != 386:
    print('Wrong Flag!!!')
    exit()
elif inp[2] + inp[37] + inp[32] + inp[41] + inp[9] + inp[13] != 485:
    print('Wrong Flag!!!')
    exit()
elif inp[25] + inp[18] + inp[25] + inp[41] + inp[40] + inp[11] != 566:
    print('Wrong Flag!!!')
    exit()
elif inp[36] + inp[37] + inp[4] + inp[12] + inp[35] + inp[42] != 546:
    print('Wrong Flag!!!')
    exit()
elif inp[45] + inp[32] + inp[12] + inp[19] + inp[16] + inp[3] != 371:
    print('Wrong Flag!!!')
    exit()
print('Correct!!! Here is your flag: ' + flag)
```

Nhìn qua bài ta thấy flag của chúng ta gồm 49 kí tự, và phải thỏa mãn các điiều kiện của if else sao cho tổng các kí tự phải bằng giá trị cụ thể ở trong dòng if đó.

Ở đây để tránh mất thời gian tìm từng kí tự của flag, mình sẽ sử dụng module sympy của Python để giải luôn hệ phương trình.

```python3
from sympy import symbols, Eq, solve

# Khởi tạo các biến cho từng ký tự của mảng inp
inp = symbols('inp0:49')

# Định nghĩa các phương trình
equations = [
    Eq(inp[30] + inp[44] + inp[16] + inp[38] + inp[47] + inp[7], 398),
    Eq(inp[41] + inp[22] + inp[38] + inp[33] + inp[28] + inp[20], 451),
    Eq(inp[10] + inp[3] + inp[39] + inp[14] + inp[4] + inp[47], 440),
    Eq(inp[2] + inp[12] + inp[45] + inp[4] + inp[42] + inp[30], 581),
    Eq(inp[36] + inp[36] + inp[26] + inp[43] + inp[21] + inp[1], 587),
    Eq(inp[16] + inp[3] + inp[16] + inp[20] + inp[38] + inp[39], 274),
    Eq(inp[28] + inp[39] + inp[18] + inp[38] + inp[47] + inp[8], 372),
    Eq(inp[25] + inp[19] + inp[36] + inp[19] + inp[20] + inp[31], 470),
    Eq(inp[44] + inp[27] + inp[5] + inp[41] + inp[16] + inp[42], 565),
    Eq(inp[46] + inp[35] + inp[8] + inp[1] + inp[4] + inp[47], 447),
    Eq(inp[41] + inp[20] + inp[42] + inp[40] + inp[3] + inp[43], 503),
    Eq(inp[36] + inp[4] + inp[21] + inp[46] + inp[34] + inp[38], 532),
    Eq(inp[43] + inp[45] + inp[3] + inp[45] + inp[3] + inp[17], 382),
    Eq(inp[24] + inp[2] + inp[6] + inp[2] + inp[25] + inp[1], 490),
    Eq(inp[38] + inp[41] + inp[33] + inp[34] + inp[21] + inp[42], 569),
    Eq(inp[17] + inp[38] + inp[1] + inp[15] + inp[46] + inp[35], 364),
    Eq(inp[40] + inp[17] + inp[34] + inp[33] + inp[39] + inp[19], 398),
    Eq(inp[18] + inp[21] + inp[4] + inp[27] + inp[19] + inp[29], 541),
    Eq(inp[30] + inp[34] + inp[42] + inp[26] + inp[18] + inp[47], 588),
    Eq(inp[23] + inp[24] + inp[30] + inp[1] + inp[13] + inp[7], 471),
    Eq(inp[17] + inp[16] + inp[32] + inp[16] + inp[15] + inp[14], 343),
    Eq(inp[30] + inp[10] + inp[24] + inp[3] + inp[40] + inp[3], 519),
    Eq(inp[10] + inp[34] + inp[27] + inp[38] + inp[46] + inp[40], 480),
    Eq(inp[6] + inp[6] + inp[46] + inp[35] + inp[5] + inp[13], 357),
    Eq(inp[18] + inp[16] + inp[5] + inp[6] + inp[12] + inp[32], 411),
    Eq(inp[1] + inp[3] + inp[37] + inp[4] + inp[22] + inp[44], 514),
    Eq(inp[26] + inp[11] + inp[12] + inp[47] + inp[22] + inp[2], 541),
    Eq(inp[32] + inp[32] + inp[18] + inp[34] + inp[31] + inp[37], 454),
    Eq(inp[38] + inp[25] + inp[1] + inp[23] + inp[28] + inp[27], 403),
    Eq(inp[37] + inp[11] + inp[2] + inp[24] + inp[39] + inp[21], 457),
    Eq(inp[21] + inp[4] + inp[3] + inp[11] + inp[42] + inp[2], 588),
    Eq(inp[11] + inp[36] + inp[27] + inp[1] + inp[18] + inp[19], 549),
    Eq(inp[16] + inp[18] + inp[37] + inp[41] + inp[25] + inp[45], 446),
    Eq(inp[19] + inp[19] + inp[18] + inp[8] + inp[25] + inp[14], 453),
    Eq(inp[19] + inp[2] + inp[40] + inp[34] + inp[27] + inp[5], 461),
    Eq(inp[48] + inp[41] + inp[33] + inp[41] + inp[23] + inp[37], 533),
    Eq(inp[45] + inp[9] + inp[8] + inp[32] + inp[4] + inp[26], 531),
    Eq(inp[47] + inp[27] + inp[2] + inp[32] + inp[3] + inp[38], 393),
    Eq(inp[32] + inp[27] + inp[2] + inp[34] + inp[27] + inp[14], 506),
    Eq(inp[24] + inp[14] + inp[39] + inp[20] + inp[3] + inp[17], 365),
    Eq(inp[10] + inp[17] + inp[43] + inp[28] + inp[48] + inp[48], 565),
    Eq(inp[35] + inp[47] + inp[27] + inp[42] + inp[35] + inp[37], 415),
    Eq(inp[10] + inp[37] + inp[37] + inp[44] + inp[21] + inp[15], 502),
    Eq(inp[9] + inp[44] + inp[9] + inp[48] + inp[38] + inp[15], 600),
    Eq(inp[16] + inp[47] + inp[12] + inp[27] + inp[39] + inp[16], 386),
    Eq(inp[2] + inp[37] + inp[32] + inp[41] + inp[9] + inp[13], 485),
    Eq(inp[25] + inp[18] + inp[25] + inp[41] + inp[40] + inp[11], 566),
    Eq(inp[36] + inp[37] + inp[4] + inp[12] + inp[35] + inp[42], 546),
    Eq(inp[45] + inp[32] + inp[12] + inp[19] + inp[16] + inp[3], 371)
]

# Giải hệ phương trình
solution = solve(equations, inp)
#print(solution)
flag = {}
for symbol in solution.keys():
    key = str(symbol)
    key = int(key.replace('inp', ''))
    flag[key] = solution[symbol]
s = 'K'
for key in sorted(flag.keys()):
    s += chr(flag[key])
print(s)
#flag = 'KCSC{700_much_1f-3l53_f0r_fl46ch3ck3r!!!7ry_z3<3}'
```
**Flag: KCSC{700_much_1f-3l53_f0r_fl46ch3ck3r!!!7ry_z3<3}**

### Go
```
// main.main
void __fastcall main_main()
{
    __int64 v0; // rax
    __int64 v1; // rcx
    __int64 v2; // rbx
    __int64 v3; // r14
    __int128 v4; // xmm15
    __int64 v5; // rbx
    string *v6; // rcx
    __int64 i; // rax
    __int64 v8; // r9
    unsigned __int64 v9; // r8
    char *ptr; // rdi
    size_t len; // rsi
    int v12; // eax
    int v13; // ecx
    int v14; // r8d
    int v15; // r9d
    int v16; // r10d
    int v17; // r11d
    __int64 v18; // rax
    __int64 v19; // [rsp+38h] [rbp-200h]
    __int64 v20; // [rsp+40h] [rbp-1F8h]
    char v21[72]; // [rsp+48h] [rbp-1F0h] BYREF
    char v22; // [rsp+90h] [rbp-1A8h] BYREF
    string *p_string; // [rsp+1D8h] [rbp-60h]
    __int128 v24; // [rsp+1E0h] [rbp-58h] BYREF
    _QWORD v25[2]; // [rsp+1F0h] [rbp-48h] BYREF
    _QWORD v26[2]; // [rsp+200h] [rbp-38h] BYREF
    _QWORD v27[2]; // [rsp+210h] [rbp-28h] BYREF
    _QWORD v28[2]; // [rsp+220h] [rbp-18h] BYREF

    while ( (unsigned __int64)&v22 <= *(_QWORD *)(v3 + 0x10) )
    {
        v0 = runtime_morestack_noctxt();
    }

    v20 = 0x12LL;
    ((void (__golang *)(__int64, __int64, __int64, char *, void *))loc_45F062)(v0, v2, v1, v21, &unk_4DD358);
    p_string = (string *)runtime_newobject((const RTYPE *)&RTYPE_string);
    p_string->ptr = 0LL;
    v28[0] = &RTYPE_string;
    v28[1] = &Enter_your_flag;
    fmt_Fprint(go_itab__os_File_io_Writer, os_Stdout, v28, 1LL, 1LL);
    v27[0] = &RTYPE__ptr_string;
    v27[1] = p_string;
    v5 = os_Stdin;
    fmt_Fscanln(go_itab__os_File_io_Reader, os_Stdin, v27, 1LL, 1LL);
    v6 = p_string;
    if ( p_string->len != 0x33 )
    {
        v26[0] = &RTYPE_string;
        v26[1] = &Wrong_length;
        v5 = os_Stdout;
        fmt_Fprintln(go_itab__os_File_io_Writer, os_Stdout, v26, 1LL, 1LL);
        os_Exit(1LL);
        v6 = p_string;
    }

    for ( i = 0LL; i < 0x33; i = v8 + 1 )
    {
        if ( i >= v6->len )
        {
            runtime_panicIndex(i, v5, v6->len);
        }

        v8 = i;
        v9 = i - (i & 0xFFFFFFFFFFFFFFE0LL);
        if ( v9 >= 0x20 )
        {
            runtime_panicIndex(v9, v5, 0x20LL);
        }

        if ( *(_QWORD *)&v21[8 * i - 8] != ((unsigned __int8)szYXV0aG9ybm9vY[v9] ^ (unsigned __int64)(unsigned __int8)v6->ptr[i]) )
        {
            v19 = i;
            v25[0] = &RTYPE_string;
            v25[1] = &Wrong;
            v5 = os_Stdout;
            fmt_Fprintln(go_itab__os_File_io_Writer, os_Stdout, v25, 1LL, 1LL);
            os_Exit(1LL);
            v6 = p_string;
            v8 = v19;
        }
    }

    v24 = v4;
    ptr = v6->ptr;
    len = v6->len;
    v12 = runtime_concatstring2(0LL, "Correct!! Here is your flag: ", 0x1DLL, v6->ptr, len);
    v18 = runtime_convTstring(
              v12,
              (unsigned int)"Correct!! Here is your flag: ",
              v13,
              (_DWORD)ptr,
              len,
              v14,
              v15,
              v16,
              v17);
    *(_QWORD *)&v24 = &RTYPE_string;
    *((_QWORD *)&v24 + 1) = v18;
    fmt_Fprintln(go_itab__os_File_io_Writer, os_Stdout, &v24, 1LL, 1LL);
    os_Exit(1LL);
}
```

Load vào IDA.

![image](https://github.com/user-attachments/assets/c122fe30-91a6-4ef6-a1e6-216f38c0a065)

Ở đây ta thấy điều kiện check ```   if ( p_string->len != 0x33 )```, ta biết được flag sẽ gồm 0x33 kí tự. v6 chính là con trỏ chứa input nhập vào.

![image](https://github.com/user-attachments/assets/db7a023b-ec67-4861-bd10-99e8774ca36e)


Vòng for sẽ duyệt qua từng kí tự của flag. Ở dòng này:
```
if ( *(_QWORD *)&v21[8 * i - 8] != ((unsigned __int8)szYXV0aG9ybm9vY[v9] ^ (unsigned __int64)(unsigned __int8)v6->ptr[i]) )
```

Nó sẽ check xem giá trị ở vị trí 8*i - 8 của mảng v21 có = lần lượt các giá trị tương ứng của mảng ```szYXV0aG9ybm9vY``` xor với mảng v6 không.

Xref đến v21 thì nó được gọi ở hàm ```loc_45F062```:
```
((void (__golang *)(__int64, __int64, __int64, char *, void *))loc_45F062)(v0, v2, v1, v21, &unk_4DD358);
```

Hàm ```loc_45F062```:

```
// runtime.duffcopy
void __golang runtime_duffcopy(__int64 a1, __int64 a2, __int64 a3, _OWORD *a4, __int128 *a5)
{
    __int128 v5; // xmm0
    __int128 *v6; // rsi
    __int128 *v7; // rdi
    __int128 v8; // xmm0
    __int128 v9; // xmm0
    __int128 v10; // xmm0
    __int128 v11; // xmm0
    __int128 v12; // xmm0
    __int128 v13; // xmm0
    __int128 v14; // xmm0
    __int128 v15; // xmm0
    __int128 v16; // xmm0
    __int128 v17; // xmm0
    __int128 v18; // xmm0
    __int128 v19; // xmm0
    __int128 v20; // xmm0
    __int128 v21; // xmm0
    __int128 v22; // xmm0
    __int128 v23; // xmm0
    __int128 v24; // xmm0
    __int128 v25; // xmm0
    __int128 v26; // xmm0
    __int128 v27; // xmm0
    __int128 v28; // xmm0
    __int128 v29; // xmm0
    __int128 v30; // xmm0
    __int128 v31; // xmm0
    __int128 v32; // xmm0
    __int128 v33; // xmm0
    __int128 v34; // xmm0
    __int128 v35; // xmm0
    __int128 v36; // xmm0
    __int128 v37; // xmm0
    __int128 v38; // xmm0
    __int128 v39; // xmm0
    __int128 v40; // xmm0
    __int128 v41; // xmm0
    __int128 v42; // xmm0
    __int128 v43; // xmm0
    __int128 v44; // xmm0
    __int128 v45; // xmm0
    __int128 v46; // xmm0
    __int128 v47; // xmm0
    __int128 v48; // xmm0
    __int128 v49; // xmm0
    __int128 v50; // xmm0
    __int128 v51; // xmm0
    __int128 v52; // xmm0
    __int128 v53; // xmm0
    __int128 v54; // xmm0
    __int128 v55; // xmm0
    __int128 v56; // xmm0
    __int128 v57; // xmm0
    __int128 v58; // xmm0
    __int128 v59; // xmm0
    __int128 v60; // xmm0
    __int128 v61; // xmm0
    __int128 v62; // xmm0
    __int128 v63; // xmm0
    __int128 v64; // xmm0
    __int128 v65; // xmm0
    __int128 v66; // xmm0
    __int128 v67; // xmm0
    __int128 v68; // xmm0

    v5 = *a5;
    v6 = a5 + 1;
    *a4 = v5;
    v7 = a4 + 1;
    v8 = *v6++;
    *v7++ = v8;
    v9 = *v6++;
    *v7++ = v9;
    v10 = *v6++;
    *v7++ = v10;
    v11 = *v6++;
    *v7++ = v11;
    v12 = *v6++;
    *v7++ = v12;
    v13 = *v6++;
    *v7++ = v13;
    v14 = *v6++;
    *v7++ = v14;
    v15 = *v6++;
    *v7++ = v15;
    v16 = *v6++;
    *v7++ = v16;
    v17 = *v6++;
    *v7++ = v17;
    v18 = *v6++;
    *v7++ = v18;
    v19 = *v6++;
    *v7++ = v19;
    v20 = *v6++;
    *v7++ = v20;
    v21 = *v6++;
    *v7++ = v21;
    v22 = *v6++;
    *v7++ = v22;
    v23 = *v6++;
    *v7++ = v23;
    v24 = *v6++;
    *v7++ = v24;
    v25 = *v6++;
    *v7++ = v25;
    v26 = *v6++;
    *v7++ = v26;
    v27 = *v6++;
    *v7++ = v27;
    v28 = *v6++;
    *v7++ = v28;
    v29 = *v6++;
    *v7++ = v29;
    v30 = *v6++;
    *v7++ = v30;
    v31 = *v6++;
    *v7++ = v31;
    v32 = *v6++;
    *v7++ = v32;
    v33 = *v6++;
    *v7++ = v33;
    v34 = *v6++;
    *v7++ = v34;
    v35 = *v6++;
    *v7++ = v35;
    v36 = *v6++;
    *v7++ = v36;
    v37 = *v6++;
    *v7++ = v37;
    v38 = *v6++;
    *v7++ = v38;
    v39 = *v6++;
    *v7++ = v39;
    v40 = *v6++;
    *v7++ = v40;
    v41 = *v6++;
    *v7++ = v41;
    v42 = *v6++;
    *v7++ = v42;
    v43 = *v6++;
    *v7++ = v43;
    v44 = *v6++;
    *v7++ = v44;
    v45 = *v6++;
    *v7++ = v45;
    v46 = *v6++;
    *v7++ = v46;
    v47 = *v6++;
    *v7++ = v47;
    v48 = *v6++;
    *v7++ = v48;
    v49 = *v6++;
    *v7++ = v49;
    v50 = *v6++;
    *v7++ = v50;
    v51 = *v6++;
    *v7++ = v51;
    v52 = *v6++;
    *v7++ = v52;
    v53 = *v6++;
    *v7++ = v53;
    v54 = *v6++;
    *v7++ = v54;
    v55 = *v6++;
    *v7++ = v55;
    v56 = *v6++;
    *v7++ = v56;
    v57 = *v6++;
    *v7++ = v57;
    v58 = *v6++;
    *v7++ = v58;
    v59 = *v6++;
    *v7++ = v59;
    v60 = *v6++;
    *v7++ = v60;
    v61 = *v6++;
    *v7++ = v61;
    v62 = *v6++;
    *v7++ = v62;
    v63 = *v6++;
    *v7++ = v63;
    v64 = *v6++;
    *v7++ = v64;
    v65 = *v6++;
    *v7++ = v65;
    v66 = *v6++;
    *v7++ = v66;
    v67 = *v6++;
    *v7++ = v67;
    v68 = *v6++;
    *v7++ = v68;
    *v7 = *v6;
    v7[1] = v6[1];
}
```

Hàm này đơn giản là copy toàn bộ giá trị tại địa chỉ của mảng ```unk_4DD358``` vào mảng v21.

Vậy chúng ta đã biết được mảng v21, mảng ```szYXV0aG9ybm9vY```,xref thì như ta thấy ở hình dưới:


![image](https://github.com/user-attachments/assets/a46950e7-d4ce-4687-8705-860433a4a994)


Vậy chỉ cần xor ngược lại ta sẽ được flag ban đầu chứa trong mảng v6.

```python3
v21 = [27,   0,   0,   0,   0,   0,   0,   0,   5,   0, 
    0,   0,   0,   0,   0,   0, 115,   0,   0,   0, 
    0,   0,   0,   0,  26,   0,   0,   0,   0,   0, 
    0,   0, 112,   0,   0,   0,   0,   0,   0,   0, 
   81,   0,   0,   0,   0,   0,   0,   0,  72,   0, 
    0,   0,   0,   0,   0,   0,  87,   0,   0,   0, 
    0,   0,   0,   0,  50,   0,   0,   0,   0,   0, 
    0,   0,   8,   0,   0,   0,   0,   0,   0,   0, 
   67,   0,   0,   0,   0,   0,   0,   0,   6,   0, 
    0,   0,   0,   0,   0,   0,  94,   0,   0,   0, 
    0,   0,   0,   0,   5,   0,   0,   0,   0,   0, 
    0,   0,  93,   0,   0,   0,   0,   0,   0,   0, 
   27,   0,   0,   0,   0,   0,   0,   0,  91,   0, 
    0,   0,   0,   0,   0,   0,   5,   0,   0,   0, 
    0,   0,   0,   0,  25,   0,   0,   0,   0,   0, 
    0,   0, 110,   0,   0,   0,   0,   0,   0,   0, 
    0,   0,   0,   0,   0,   0,   0,   0, 124,   0, 
    0,   0,   0,   0,   0,   0,  41,   0,   0,   0, 
    0,   0,   0,   0,   1,   0,   0,   0,   0,   0, 
    0,   0,  63,   0,   0,   0,   0,   0,   0,   0, 
   64,   0,   0,   0,   0,   0,   0,   0,   6,   0, 
    0,   0,   0,   0,   0,   0,  15,   0,   0,   0, 
    0,   0,   0,   0,   1,   0,   0,   0,   0,   0, 
    0,   0,  35,   0,   0,   0,   0,   0,   0,   0, 
   11,   0,   0,   0,   0,   0,   0,   0, 106,   0, 
    0,   0,   0,   0,   0,   0,   7,   0,   0,   0, 
    0,   0,   0,   0,  97,   0,   0,   0,   0,   0, 
    0,   0,  85,   0,   0,   0,   0,   0,   0,   0, 
    0,   0,   0,   0,   0,   0,   0,   0, 117,   0, 
    0,   0,   0,   0,   0,   0,  93,   0,   0,   0, 
    0,   0,   0,   0,  24,   0,   0,   0,   0,   0, 
    0,   0,  83,   0,   0,   0,   0,   0,   0,   0, 
   90,   0,   0,   0,   0,   0,   0,   0, 102,   0, 
    0,   0,   0,   0,   0,   0,  74,   0,   0,   0, 
    0,   0,   0,   0, 106,   0,   0,   0,   0,   0, 
    0,   0,  81,   0,   0,   0,   0,   0,   0,   0, 
    2,   0,   0,   0,   0,   0,   0,   0,  73,   0, 
    0,   0,   0,   0,   0,   0,  67,   0,   0,   0, 
    0,   0,   0,   0,  76,   0,   0,   0,   0,   0, 
    0,   0,  72,   0,   0,   0,   0,   0,   0,   0]
sz = 'YXV0aG9ybm9vYm1hbm5uZnJvbWtjc2M='
flag = 'K'
for i in range(1,0x33):
    v9 = i % 0x20
    flag +=  chr(v21[8*i-8] ^ ord(sz[v9]))
print(flag)
#flag = 'KCSC{7h15_15_345y60l4n6_ch4ll3n63_7ea2da17_<3<3!!!}'
```
**Flag: KCSC{7h15_15_345y60l4n6_ch4ll3n63_7ea2da17_<3<3!!!}**

### riel warmup

Load vào IDA:

![image](https://github.com/user-attachments/assets/68c85749-d07c-4d0f-b766-2701788ef162)

Nhìn sơ qua thì ta thấy flag được tách thành từng đoạn

```
                                       push    rbp
.text:00007FF766AE159F                 mov     rbp, rsp
.text:00007FF766AE15A2                 sub     rsp, 50h
.text:00007FF766AE15A6                 call    __main
.text:00007FF766AE15A6
.text:00007FF766AE15AB                 mov     rax, 7661687B4353434Bh
.text:00007FF766AE15B5                 mov     rdx, 776F6E6B5F755F65h
.text:00007FF766AE15BF                 mov     [rbp+var_20], rax
.text:00007FF766AE15C3                 mov     [rbp+var_18], rdx
.text:00007FF766AE15C7                 mov     [rbp+var_10], 6Eh ; 'n'
.text:00007FF766AE15CD                 call    hide
.text:00007FF766AE15CD
.text:00007FF766AE15D2                 mov     [rbp+var_8], rax
.text:00007FF766AE15D6                 mov     [rbp+var_25], 4144495Fh
.text:00007FF766AE15DD                 mov     [rbp+var_21], 0
.text:00007FF766AE15E1                 lea     rcx, Format     ; "find flag yourself :))\n"
.text:00007FF766AE15E8                 call    printf_0
.text:00007FF766AE15E8
.text:00007FF766AE15ED                 lea     rax, flag4      ; "^^}pumraw_laer_siht_retfa_"
.text:00007FF766AE15F4                 add     rsp, 50h
.text:00007FF766AE15F8                 pop     rbp
.text:00007FF766AE15F9                 retn
```

Push rbp vào, đọc sơ qua ta thấy các đoạn của flag được chứa trong thanh ghi rbp, và từng đoạn này được viết ngược lại. Ta chỉ cần lấy ngược từng đoạn kí tự và gộp lại với nhau sẽ ra flag

```python3

a = '7661687B4353434B'
b = '776F6E6B5F755F65'
c = 0x6e
d = '4144495F'
e = "^^}pumraw_laer_siht_retfa_"

a = ''.join([chr(int(a[i:i+2],16)) for i in range(0,len(a),2)])
b = ''.join([chr(int(b[i:i+2],16)) for i in range(0,len(b),2)])
d = ''.join([chr(int(d[i:i+2],16)) for i in range(0,len(d),2)])

flag = a[::-1] + b[::-1] + chr(c) + d[::-1] + e[::-1]
print(flag)

#flag = 'KCSC{have_u_known_how_to_use_IDA_after_this_real_warmup}'
```
**Flag: KCSC{have_u_known_how_to_use_IDA_after_this_real_warmup}**

### s1mple flag checker but no SEE

```java
import java.util.*;

public class Flag_Checker {
	static int[] pos = { 10, 15, 19, 28, 30, 44, 49 };
	static int[] f1nal = { 18, 20, 22, 23, 25, 26, 27, 31, 33, 34, 36, 37, 39, 40 };

	public static boolean check(boolean ret, String s) {
		if ((!s.substring(0, 5).equals("KCSC{")) || !(s.charAt(s.length() - 1) == '}'))
			ret = false;
		return ret;
	}

	public static boolean check(boolean ret, String s, int[] arr) {
		for (int i = 0; i < arr.length; ++i) {
			if (s.charAt(arr[i]) != 95)
				return false;
		}
		return ret;
	}

	public static boolean check(boolean ret, String s, boolean[] arr) {
		int[] num = new int[10];

		for (int i = 0; i < s.length(); ++i) {
			if (Character.isDigit(s.charAt(i)) != arr[i])
				ret = false;
		}
		for (int i = 0; i < pos.length; ++i) {
			num[i] = s.charAt(pos[i]) - 0x30;
		}
		if ((num[1] != num[6])
				|| (num[0] != num[1] - num[6])
				|| (num[3] + num[4] != num[1])
				|| (num[6] * num[5] != 20)
				|| (num[0] != num[2])
				|| (Math.pow(num[3], num[5]) != 256)
				|| ((num[1] ^ num[4]) != 4)
				|| (num[1] != 5)) {
			ret = false;
		}
		return ret;
	}	

	public static boolean check(boolean ret, String s, char[] arr) {
		int l = 5, r = 55, cnt = 0;
		while (cnt < arr.length) {
			while (!Character.isLetter(s.charAt(l)))
				l++;
			while (!Character.isLetter(s.charAt(r)))
				r--;
			if (s.charAt(r) != arr[cnt] || s.charAt(l) != arr[cnt + 1]) {
				ret = false;
			}
			cnt += 2;
			l++;
			r--;
		}
		return ret;
	}

	public static boolean check(boolean ret, String s, String tmp) {
		for (int i = 0; i < f1nal.length; ++i)
			tmp += s.charAt(f1nal[i]);

		if (((tmp.charAt(2) ^ tmp.charAt(0)) != 32)
				|| (tmp.charAt(0) + tmp.charAt(5) + tmp.charAt(6) != 294)
				|| (tmp.charAt(1) * tmp.charAt(3) != 8160)
				|| ((tmp.charAt(3) ^ tmp.charAt(4)) != 44)
				|| ((tmp.charAt(2) ^ tmp.charAt(3)) != 9)
				|| (tmp.charAt(0) * tmp.charAt(3) != 8058)
				|| (tmp.charAt(3) - tmp.charAt(4) != 28)
				|| ((tmp.charAt(2) ^ tmp.charAt(7)) != 28)
				|| (tmp.charAt(12) - tmp.charAt(13) + tmp.charAt(9) - tmp.charAt(8) != 38)
				|| (tmp.charAt(3) - tmp.charAt(4) != 28)
				|| ((tmp.charAt(2) ^ tmp.charAt(11)) != 0)
				|| (tmp.charAt(4) - tmp.charAt(6) != -44)
				|| ((tmp.charAt(6) ^ tmp.charAt(8)) != 19)
				|| (tmp.charAt(9) - tmp.charAt(5) != 25)
				|| (tmp.charAt(0) + tmp.charAt(5) + tmp.charAt(7) != 291)
				|| ((tmp.charAt(10) ^ tmp.charAt(5)) != 21)
				|| (tmp.charAt(1) != tmp.charAt(13))
				|| (tmp.charAt(11) != 111)
				|| (s.charAt(s.length() - 2) != 63)) {
			ret = false;
		}
		return ret;
	}

	public static void main(String[] args) {
		boolean[] isDigit = { false, false, false, false, false, false, false, false, false, false, true, false,
				false, false, false, true, false, false, false, true, false, false, false, false, false, false, false,
				false, true, false, true, false, false, false, false, false, false, false, false, false, false, false,
				false, false, true, false, false, false, false, true, false, false, false, false, false, false, false };
		int[] pos = { 17, 21, 24, 29, 32, 35, 38, 47, 52 };
		char[] let = { 't', 'P', 'i', 'o', 't', 'L', 'n', 'y', 'i', 'm', 'h', 'r', 'c', 'p', 'o', 'h', 'r', 'i',
				'P', 'm' };
		Scanner inp = new Scanner(System.in);
		System.out.print("Enter flag: ");
		String input = inp.next();
		boolean ret = true;
		if (check(check(check(check(check(ret, input), input, isDigit), input, pos), input, let), input, ""))
			System.out.println("Flag is correct");
		else
			System.out.println("Try another one");
	}
}
```

Bài cho 5 hàm check flag, với mỗi hàm sẽ kiểm tra khác nhau, bao gốm có kí tự số hoặc kí tự chữ cái hoặc các symbol ở vị trí cụ thể không. 

Hàm check đầu sẽ kiểm tra 5 kí tự đầu có phải là ```KCSC{``` và kí tự cuối có phải là ```}``` không.

```java
public class Flag_Checker {
	static int[] pos = { 10, 15, 19, 28, 30, 44, 49 };
	static int[] f1nal = { 18, 20, 22, 23, 25, 26, 27, 31, 33, 34, 36, 37, 39, 40 };

	public static boolean check(boolean ret, String s) {
		if ((!s.substring(0, 5).equals("KCSC{")) || !(s.charAt(s.length() - 1) == '}'))
			ret = false;
		return ret;
	}
```

Hàm check 2 sẽ kiểm tra một vài kí tự ở vị trí cụ thể có phải là kí tự ```_``` không.

```java
	public static boolean check(boolean ret, String s, int[] arr) {
		for (int i = 0; i < arr.length; ++i) {
			if (s.charAt(arr[i]) != 95)
				return false;
		}
		return ret;
	}
```

Hàm check 3 sẽ kiểm tra một vài kí tự ở vị trí cụ thể có phải là kí tự số không, cùng với đó của đoạn sau của hàm ta cũng sẽ biết được 1 vài kí tự trong flag ở vị trí ```pos[i]```, với mảng ```pos``` được khai báo ở đầu chương trình:

```java
static int[] pos = { 10, 15, 19, 28, 30, 44, 49 };
```

```java
public static boolean check(boolean ret, String s, boolean[] arr) {
		int[] num = new int[10];

		for (int i = 0; i < s.length(); ++i) {
			if (Character.isDigit(s.charAt(i)) != arr[i])
				ret = false;
		}
		for (int i = 0; i < pos.length; ++i) {
			num[i] = s.charAt(pos[i]) - 0x30;
		}
		if ((num[1] != num[6])
				|| (num[0] != num[1] - num[6])
				|| (num[3] + num[4] != num[1])
				|| (num[6] * num[5] != 20)
				|| (num[0] != num[2])
				|| (Math.pow(num[3], num[5]) != 256)
				|| ((num[1] ^ num[4]) != 4)
				|| (num[1] != 5)) {
			ret = false;
		}
		return ret;
	}
```
Từ đoạn sau của chương trình ta sẽ tìm được lần lượt các giá trị của mảng ```num```, gồm:

```
num[0] = 0
num[1] = 5
num[2] = 0
num[3] = 4
num[4] = 1
num[5] = 4
num[6] = 5
```

Vậy ta đã biết được 7 kí tự ở vị trí cụ thể và kí tự nào ở vị trí cụ thể nào là kí tự số

Hàm check 4 sẽ kiểm tra kí tự ở vị trí cụ thể có phải là kí tự chữ cái không.

```java
public static boolean check(boolean ret, String s, char[] arr) {
		int l = 5, r = 55, cnt = 0;
		while (cnt < arr.length) {
			while (!Character.isLetter(s.charAt(l)))
				l++;
			while (!Character.isLetter(s.charAt(r)))
				r--;
			if (s.charAt(r) != arr[cnt] || s.charAt(l) != arr[cnt + 1]) {
				ret = false;
			}
			cnt += 2;
			l++;
			r--;
		}
		return ret;
	}
```

Hàm check cuối sẽ check xem kí tự ở vị trí cụ thể có thỏa mãn các điều kiện if else không.

```java
public static boolean check(boolean ret, String s, String tmp) {
		for (int i = 0; i < f1nal.length; ++i)
			tmp += s.charAt(f1nal[i]);

		if (((tmp.charAt(2) ^ tmp.charAt(0)) != 32)
				|| (tmp.charAt(0) + tmp.charAt(5) + tmp.charAt(6) != 294)
				|| (tmp.charAt(1) * tmp.charAt(3) != 8160)
				|| ((tmp.charAt(3) ^ tmp.charAt(4)) != 44)
				|| ((tmp.charAt(2) ^ tmp.charAt(3)) != 9)
				|| (tmp.charAt(0) * tmp.charAt(3) != 8058)
				|| (tmp.charAt(3) - tmp.charAt(4) != 28)
				|| ((tmp.charAt(2) ^ tmp.charAt(7)) != 28)
				|| (tmp.charAt(12) - tmp.charAt(13) + tmp.charAt(9) - tmp.charAt(8) != 38)
				|| (tmp.charAt(3) - tmp.charAt(4) != 28)
				|| ((tmp.charAt(2) ^ tmp.charAt(11)) != 0)
				|| (tmp.charAt(4) - tmp.charAt(6) != -44)
				|| ((tmp.charAt(6) ^ tmp.charAt(8)) != 19)
				|| (tmp.charAt(9) - tmp.charAt(5) != 25)
				|| (tmp.charAt(0) + tmp.charAt(5) + tmp.charAt(7) != 291)
				|| ((tmp.charAt(10) ^ tmp.charAt(5)) != 21)
				|| (tmp.charAt(1) != tmp.charAt(13))
				|| (tmp.charAt(11) != 111)
				|| (s.charAt(s.length() - 2) != 63)) {
			ret = false;
		}
		return ret;
	}
```

Phần cuối của chương trình là hàm ```main```

```java
public static void main(String[] args) {
		boolean[] isDigit = { false, false, false, false, false, false, false, false, false, false, true, false,
				false, false, false, true, false, false, false, true, false, false, false, false, false, false, false,
				false, true, false, true, false, false, false, false, false, false, false, false, false, false, false,
				false, false, true, false, false, false, false, true, false, false, false, false, false, false, false };
		int[] pos = { 17, 21, 24, 29, 32, 35, 38, 47, 52 };
		char[] let = { 't', 'P', 'i', 'o', 't', 'L', 'n', 'y', 'i', 'm', 'h', 'r', 'c', 'p', 'o', 'h', 'r', 'i',
				'P', 'm' };
		Scanner inp = new Scanner(System.in);
		System.out.print("Enter flag: ");
		String input = inp.next();
		boolean ret = true;
		if (check(check(check(check(check(ret, input), input, isDigit), input, pos), input, let), input, ""))
			System.out.println("Flag is correct");
		else
			System.out.println("Try another one");
	}
}
```

Ta thấy ở đây:
```java
if (check(check(check(check(check(ret, input), input, isDigit), input, pos), input, let), input, ""))
```

Ở đây ta không biết sẽ gọi hàm check nào trước, nhưng nếu để ý kỹ, ta thấy: hàm check trong cùng chính là hàm check đầu, vì chỉ có 2 tham số đầu vào, hàm check tiếp theo sẽ là hàm check thứ 3, vì hàm check thứ 3 sẽ truyền vào 1 boolean, mà để ý ở hàm main chỉ có mảng ```isDigit``` là boolean. Tiếp theo sẽ là hàm check thứ 2, vì truyền vào 1 int mà chỉ có mảng ```pos``` là int. Tiếp theo sẽ là hàm 4 vì truyền vào là 1 char. Cuối cùng sẽ là hàm check 5.

Nhìn vào mảng ```isDigit```, ta sẽ biết được kí tự số ở vị trí nào trong flag, cũng như biết được độ dài của flag gồm 57 kí tự.
Nhìn vào mảng ```pos``` ở đầu chương trình và ở hàm main, ta sẽ biết được vị trí của kí tự ```_``` và kí tự cụ thể cũng như vị trí của nó ở trong hàm check 3.
Nhìn vào mảng ```f1nal``` ở đầu chương trình, ta cũng sẽ biết được một vài kí tự cụ thể cũng như vị trí của nó trong flag qua hàm check 5.

Từ từng dữ kiện trên, ta sẽ lấy được các vị trí mà ở đó là chữ cái, và chữ cái đó nằm trong mảng ```let``` ở cuối hàm main. Mảng ```let``` truyền vào hàm 4, gồm 20 kí tự, sẽ gán 10 giá trị ở index lẻ cho các vị trí theo thứ tự lần lượt, 10 giá trị cuối sẽ chạy từ cuối mảng, là các giá trị ở index chẵn sẽ gán cho các vị trí còn lại chứa chữ cái trong flag.

Từ các bước trên, ta sẽ có được script để lấy flag.

```python3
_pos = [10, 15, 19, 28, 30, 44, 49]
pos = [17, 21, 24, 29, 32, 35, 38, 47, 52]
final = [18, 20, 22, 23, 25, 26, 27, 31, 33, 34, 36, 37, 39, 40]
isDigit = [False, False, False, False, False, False, False, False, False, False, True, False,
				False, False, False, True, False, False, False, True, False, False, False, False, False, False, False,
				False, True, False, True, False, False, False, False, False, False, False, False, False, False, False,
				False, False, True, False, False, False, False, True, False, False, False, False, False, False, False]

flag = {}
flag[0] = 'K'
flag[1] = 'C'
flag[2] = 'S'
flag[3] = 'C'
flag[4] = '{'
flag[len(isDigit)-1] = '}'

num = {}
num[0] = 0
num[1] = 5
num[2] = 0
num[3] = 4
num[4] = 1
num[5] = 4
num[6] = 5





for i in range(len(isDigit)):
    if isDigit[i] == True:
        flag[i] = '0'
               
for i in range(len(_pos)):
    flag[_pos[i]] = chr(num[i] + 0x30)

for i in range(len(pos)):
    flag[pos[i]] = chr(95)
for i in range(len(isDigit)):
    if i not in flag.keys():
        flag[i] = ' '
l = 5
r = 55
cnt = 0
let = ['t', 'P', 'i', 'o', 't', 'L', 'n', 'y', 'i', 'm', 'h', 'r', 'c', 'p', 'o', 'h', 'r', 'i',
				'P', 'm']
index_let = []
index_digit = [i for i in range(len(isDigit)) if isDigit[i] == True]
for i in range(57):
    if i not in final and i not in pos and i not in index_digit and i not in _pos and i not in [0,1,2,3,4,55,56]:
        index_let.append(i)
first_part = [let[i] for i in range(len(let)) if i % 2 != 0]
second_part = [let[i] for i in range(len(let)) if i % 2 == 0][::-1]
for i in range(10):
    flag[index_let[i]] = first_part[i]
for i in range(10):
    flag[index_let[10+i]] = second_part[i]
    
    

flag[len(isDigit)-2] = chr(63)

flag[final[11]] = flag[final[2]] = chr(111)
flag[final[7]] = chr(ord(flag[final[2]]) ^ 28)
flag[final[3]] = chr(ord(flag[final[2]]) ^ 9)
flag[final[4]] = chr(ord(flag[final[3]]) - 28)
flag[final[1]] = chr(8160 // ord(flag[final[3]]))
flag[final[0]] = chr(8058 // ord(flag[final[3]]))
flag[final[6]] = chr(44 + ord(flag[final[4]]))
flag[final[5]] = chr(294 - ord(flag[final[0]]) - ord(flag[final[6]]))
flag[final[8]] = chr(19 ^ ord(flag[final[6]]))
flag[final[9]] = chr(25 + ord(flag[final[5]]))
flag[final[10]] = chr(21 ^ ord(flag[final[5]]))
flag[final[13]] = flag[final[1]]
flag[final[12]] = chr(38 + ord(flag[final[8]]) + ord(flag[final[13]]) - ord(flag[final[9]]))


for key in sorted(flag.keys()):
    print(flag[key],end='')
```

**Flag: KCSC{PoLym0rphi5m_O0P_of_Jav4_1s_ez_to_aPPro4ch_i5nt_it?}**

### Từng quen (sau giải mới làm ra)

Load vào IDA:

![image](https://github.com/user-attachments/assets/4ff68bd4-054f-447e-b3d9-0367a6afd2e7)


Key của chúng ta sẽ là mảng ```v14``` gồm 0x10 kí tự, được gọi qua hàm srand, với seed là thời gian thực.

Nhưng ta có thể biết được 4 giá trị cuối của key, ở đoạn này:

![image](https://github.com/user-attachments/assets/d4f891e5-6c72-4479-8c2f-2316e598e385)

![image](https://github.com/user-attachments/assets/3f644628-2c77-493b-acbd-2537cf5cbf8c)

Flag ban đầu sẽ được mã hóa lần lượt với từng giá trị của key.

Bởi vì v14 chỉ có 0x10 giá trị, nên khi nào đến giá trị cuối nó sẽ quay về 0. Mà flag[i] = v14[i%0x10] ^ flag[i], Mà ta đã biết được 4 kí tự cuối của key, thì ta chỉ cần tìm tại vị trí i nào của flag mà i%0x10 bằng vị trí của các giá trị cuối của key, ta sẽ tìm được kí tự tại vị trí đó của flag bằng cách xor ngược với flag đã mã hóa trong file important.

Ta biết rằng 5 giá trị đầu của flag là 'KCSC{', vậy xor ngược lại với flag mã hóa ta cũng sẽ lấy được 5 giá trị đầu của key.

```python
with open('important_note.txt','rb') as file:
    tmp = file.read()
data = []
for i in tmp:
    data.append(i)
v14 = {}
v14[0xf] = 0xef
v14[0xe] = 0xbe
v14[0xd] = 0xfe
v14[0xc] = 0xca

v14[0] = data[0] ^ ord('K')
v14[1] = data[1] ^ ord('C')
v14[2] = data[2] ^ ord('S')
v14[3] = data[3] ^ ord('C')
v14[4] = data[4] ^ ord('{')


count = 0
flag = {}
for i in range(len(data)):
    if i % 0x10 == 0xc:
        flag[i] = data[i] ^ v14[0xc]
    if i % 0x10 == 0xd:
        flag[i] = data[i] ^ v14[0xd]
    if i % 0x10 == 0xe:
        flag[i] = data[i] ^ v14[0xe]
    if i % 0x10 == 0xf:
        flag[i] = data[i] ^ v14[0xf]
    if i % 0x10 == 0:
        flag[i] = data[i] ^ v14[0]
    if i % 0x10 == 1:
        flag[i] = data[i] ^ v14[0x1]
    if i % 0x10 == 2:
        flag[i] = data[i] ^ v14[0x2]
    if i % 0x10 == 3:
        flag[i] = data[i] ^ v14[0x3]
    if i % 0x10 == 4:
        flag[i] = data[i] ^ v14[0x4]

##index = [i for i in range(len(data)) if i not in flag.keys()]
##for i in index:
##    flag[i] = ord(' ')
##lst = []
##for i in index:
##    for j in range(256):
##        if data[i] ^ j == ord('_'):
##            lst.append(j)
##
##v14[5] = ord('n') ^ data[5]
##for i in (index):
##    if i % 0x10 == 5:
##        flag[i] = data[i] ^ v14[5]
##v14[6] = ord('h') ^ data[6]
##for i in (index):
##    if i % 0x10 == 6:
##        flag[i] = data[i] ^ v14[6]
##v14[7] = ord('i') ^ data[7]
##for i in (index):
##    if i % 0x10 == 7:
##        flag[i] = data[i] ^ v14[7]
##v14[8] = ord('n') ^ data[8]
##for i in (index):
##    if i % 0x10 == 8:
##        flag[i] = data[i] ^ v14[8]
##v14[9] = ord(' ') ^ data[9]
##for i in (index):
##    if i % 0x10 == 9:
##        flag[i] = data[i] ^ v14[9]
##v14[10] = ord('e') ^ data[10]
##for i in (index):
##    if i % 0x10 == 10:
##        flag[i] = data[i] ^ v14[10]
##v14[11] = ord('m') ^ data[11]
##for i in (index):
##    if i % 0x10 == 11:
##        flag[i] = data[i] ^ v14[11]
s = ''

for key in sorted(flag.keys()):
    s += chr(flag[key])
print(s)
```
![image](https://github.com/user-attachments/assets/37aab166-64e2-419a-84e5-736516667987)

Flag sẽ trông như thế này. Mình chợt nhớ lại tên của chall là Từng quen, mà flag trông như 1 câu trong bài Từng quen:

![image](https://github.com/user-attachments/assets/d52fd9e7-d6d0-4be5-9b01-b6eb3fd93c1b)

Từ đây mình đoán được thêm flag ở vị trí 6 7 8 9 10 có thể là các kí tự `n`,`h`,`i`,`n`,` `

```python
with open('important_note.txt','rb') as file:
    tmp = file.read()
data = []
for i in tmp:
    data.append(i)
v14 = {}
v14[0xf] = 0xef
v14[0xe] = 0xbe
v14[0xd] = 0xfe
v14[0xc] = 0xca

v14[0] = data[0] ^ ord('K')
v14[1] = data[1] ^ ord('C')
v14[2] = data[2] ^ ord('S')
v14[3] = data[3] ^ ord('C')
v14[4] = data[4] ^ ord('{')


count = 0
flag = {}
for i in range(len(data)):
    if i % 0x10 == 0xc:
        flag[i] = data[i] ^ v14[0xc]
    if i % 0x10 == 0xd:
        flag[i] = data[i] ^ v14[0xd]
    if i % 0x10 == 0xe:
        flag[i] = data[i] ^ v14[0xe]
    if i % 0x10 == 0xf:
        flag[i] = data[i] ^ v14[0xf]
    if i % 0x10 == 0:
        flag[i] = data[i] ^ v14[0]
    if i % 0x10 == 1:
        flag[i] = data[i] ^ v14[0x1]
    if i % 0x10 == 2:
        flag[i] = data[i] ^ v14[0x2]
    if i % 0x10 == 3:
        flag[i] = data[i] ^ v14[0x3]
    if i % 0x10 == 4:
        flag[i] = data[i] ^ v14[0x4]

index = [i for i in range(len(data)) if i not in flag.keys()]
for i in index:
    flag[i] = ord(' ')
lst = []
for i in index:
    for j in range(256):
        if data[i] ^ j == ord('_'):
            lst.append(j)

v14[5] = ord('n') ^ data[5]
for i in (index):
    if i % 0x10 == 5:
        flag[i] = data[i] ^ v14[5]
v14[6] = ord('h') ^ data[6]
for i in (index):
    if i % 0x10 == 6:
        flag[i] = data[i] ^ v14[6]
v14[7] = ord('i') ^ data[7]
for i in (index):
    if i % 0x10 == 7:
        flag[i] = data[i] ^ v14[7]
v14[8] = ord('n') ^ data[8]
for i in (index):
    if i % 0x10 == 8:
        flag[i] = data[i] ^ v14[8]
v14[9] = ord(' ') ^ data[9]
for i in (index):
    if i % 0x10 == 9:
        flag[i] = data[i] ^ v14[9]
v14[10] = ord('e') ^ data[10]
for i in (index):
    if i % 0x10 == 10:
        flag[i] = data[i] ^ v14[10]
v14[11] = ord('m') ^ data[11]
for i in (index):
    if i % 0x10 == 11:
        flag[i] = data[i] ^ v14[11]
s = ''

for key in sorted(flag.keys()):
    s += chr(flag[key])
print(s)
```

**Flag:KCSC{nhin em anh boi roi anh thua roi tim em lam loi anh chua tung dam noi anh yeu mot ai the nay!!}**






